{
  "$schema": "https://mova.dev/schemas/mova.control_v0.schema.json",
  "version": "control_v0",
  "claude_md": {
    "inject_control_entry": true,
    "marker": "<!-- MOVA_CONTROL_ENTRY_V0 -->",
    "priority_sources": [
      "CLAUDE.md",
      ".claude/CLAUDE.md",
      "~/.claude/CLAUDE.md"
    ]
  },
  "claude_memory": {
    "enable": true,
    "sources": [
      "CLAUDE.md"
    ]
  },
  "overlay": {
    "enable": true
  },
  "settings": {
    "include_co_authored_by": true,
    "env": {}
  },
  "mcp": {
    "servers": {
      "context7": {
        "command": "cmd",
        "args": [
          "/c",
          "npx",
          "-y",
          "@upstash/context7-mcp@latest"
        ]
      }
    },
    "enable_all_project_mcp_servers": false,
    "enabled_mcpjson_servers": [
      "context7"
    ],
    "env_substitutions": {
      "format": "${VAR}",
      "default_format": "${VAR:-default}"
    }
  },
  "policy": {
    "mode": "report_only",
    "hooks": {
      "enable": true,
      "on_invalid_hook": "report_only",
      "definitions": [],
      "events": {
        "PreToolUse": [
          {
            "matcher": "Edit|MultiEdit|Write",
            "hooks": [
              {
                "type": "command",
                "command": "node \".claude/hooks/mova-guard.js\" --task pre-main",
                "timeout": 5
              }
            ]
          },
          {
            "matcher": "Bash",
            "hooks": [
              {
                "type": "command",
                "command": "node \".claude/hooks/mova-guard.js\" --task pre-bash",
                "timeout": 5
              }
            ]
          }
        ],
        "PostToolUse": [
          {
            "matcher": "Edit|MultiEdit|Write",
            "hooks": [
              {
                "type": "command",
                "command": "node \".claude/hooks/mova-guard.js\" --task post-format",
                "timeout": 30
              }
            ]
          },
          {
            "matcher": "Edit|MultiEdit|Write",
            "hooks": [
              {
                "type": "command",
                "command": "node \".claude/hooks/mova-guard.js\" --task post-test",
                "timeout": 90
              }
            ]
          }
        ],
        "UserPromptSubmit": [
          {
            "hooks": [
              {
                "type": "command",
                "command": "node \".claude/hooks/skill-eval.js\"",
                "timeout": 5
              }
            ]
          }
        ]
      }
    },
    "permissions": {
      "allow": [
        "Bash",
        "Edit",
        "Read"
      ],
      "deny": [],
      "on_conflict": "deny_wins",
      "on_unknown": "report_only"
    },
    "plugins": {
      "enable": true,
      "allowed_plugin_ids": [],
      "denied_plugin_ids": [],
      "on_unknown": "report_only",
      "enabled_plugins": {}
    }
  },
  "lsp": {
    "enabled_plugins": [],
    "config_path": ".claude/lsp.json",
    "managed": false
  },
  "skill_eval": {
    "enable": true,
    "hooks": {
      "shell": ".claude/hooks/skill-eval.js",
      "node": ".claude/hooks/skill-eval.js"
    },
    "rules_path": ".claude/hooks/skill-rules.json",
    "scoring": {
      "threshold": 0.6
    }
  },
  "observability": {
    "enable": true,
    "mode": "report_only",
    "writer": {
      "type": "node",
      "script_path": ".claude/hooks/mova-observe.js"
    },
    "output_dir": ".mova/episodes",
    "stdout_tail_bytes": 4000,
    "stderr_tail_bytes": 4000,
    "max_event_bytes": 20000,
    "tail_lines": 50,
    "include_tools": [
      "Bash",
      "Read",
      "Edit",
      "MultiEdit",
      "Write"
    ],
    "include_events": [
      "PostToolUse",
      "UserPromptSubmit",
      "Stop"
    ]
  },
  "assets": {
    "skills": [
      {
        "path": ".claude/skills/testing-patterns/SKILL.md",
        "mode": "copy_through",
        "source_path": ".claude/skills/testing-patterns/SKILL.md"
      },
      {
        "path": ".claude/skills/systematic-debugging/SKILL.md",
        "mode": "copy_through",
        "source_path": ".claude/skills/systematic-debugging/SKILL.md"
      },
      {
        "path": ".claude/skills/security-basics/SKILL.md",
        "mode": "copy_through",
        "source_path": ".claude/skills/security-basics/SKILL.md"
      },
      {
        "path": ".claude/skills/git-workflow/SKILL.md",
        "mode": "copy_through",
        "source_path": ".claude/skills/git-workflow/SKILL.md"
      }
    ],
    "agents": [
      {
        "path": ".claude/agents/code-reviewer.md",
        "mode": "copy_through",
        "source_path": ".claude/agents/code-reviewer.md"
      }
    ],
    "commands": [
      {
        "path": ".claude/commands/start.md",
        "mode": "copy_through",
        "source_path": ".claude/commands/start.md"
      },
      {
        "path": ".claude/commands/finish.md",
        "mode": "copy_through",
        "source_path": ".claude/commands/finish.md"
      }
    ],
    "rules": [
      {
        "path": ".claude/rules/code-style.md",
        "mode": "copy_through",
        "source_path": ".claude/rules/code-style.md"
      },
      {
        "path": ".claude/rules/security.md",
        "mode": "copy_through",
        "source_path": ".claude/rules/security.md"
      }
    ],
    "hooks": [
      {
        "path": ".claude/hooks/skill-eval.js",
        "mode": "copy_through",
        "source_path": ".claude/hooks/skill-eval.js"
      },
      {
        "path": ".claude/hooks/skill-rules.json",
        "mode": "copy_through",
        "source_path": ".claude/hooks/skill-rules.json"
      },
      {
        "path": ".claude/hooks/mova-guard.js",
        "mode": "copy_through",
        "source_path": ".claude/hooks/mova-guard.js"
      },
      {
        "path": ".claude/hooks/mova-observe.js",
        "mode": "copy_through",
        "source_path": ".claude/hooks/mova-observe.js"
      }
    ],
    "workflows": [],
    "docs": [],
    "dotfiles": [],
    "schemas": [],
    "services": [
      {
        "mode": "copy_through",
        "path": "services/env_resolver.js",
        "source_path": "services/env_resolver.js"
      },
      {
        "mode": "copy_through",
        "path": "services/preset_manager.js",
        "source_path": "services/preset_manager.js"
      },
      {
        "mode": "copy_through",
        "path": "services/episode_metrics_collector.js",
        "source_path": "services/episode_metrics_collector.js"
      },
      {
        "mode": "copy_through",
        "path": "services/dashboard_server.js",
        "source_path": "services/dashboard_server.js"
      },
      {
        "mode": "copy_through",
        "path": "services/hot_reloader.js",
        "source_path": "services/hot_reloader.js"
      }
    ],
    "presets": [
      {
        "mode": "copy_through",
        "path": ".claude/presets/base.preset_v0.json",
        "source_path": ".claude/presets/base.preset_v0.json"
      },
      {
        "mode": "copy_through",
        "path": ".claude/presets/development.preset_v0.json",
        "source_path": ".claude/presets/development.preset_v0.json"
      },
      {
        "mode": "copy_through",
        "path": ".claude/presets/production.preset_v0.json",
        "source_path": ".claude/presets/production.preset_v0.json"
      }
    ]
  },
  "environs": {
    "AUTO_MODE": "${AUTO_MODE:false}",
    "DEBUG_LEVEL": "${DEBUG_LEVEL:minimal}",
    "MASK_SENSITIVE": "${MASK_SENSITIVE:true}",
    "DASHBOARD_ENABLED": "${DASHBOARD_ENABLED:false}",
    "DASHBOARD_PORT": "${DASHBOARD_PORT:2773}",
    "HOT_RELOAD_ENABLED": "${HOT_RELOAD_ENABLED:false}"
  },
  "monitoring": {
    "enabled": "${DASHBOARD_ENABLED:false}",
    "port": "${DASHBOARD_PORT:2773}",
    "metrics": [
      "episodes_count",
      "error_rate",
      "performance"
    ],
    "update_interval": 30000
  },
  "versioning": {
    "enabled": "${HOT_RELOAD_ENABLED:false}",
    "backup_on_change": true,
    "auto_update_check": false,
    "rollback_levels": 5
  }
}
